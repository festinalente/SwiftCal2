<!DOCTYPE html>
<head>
  <link href='https://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet'>
  <meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0'>
  <!-- defer is required so attributes are read before the script is loaded. Alternatively
  load scripts in the foot of the page -->
  <script defer src="./clientSideJS/calendar.js"></script>
  <style>
    .code {
      border-left-style: solid;
      border-left-width: 2px;
      border-left-color: #f15925;
      background-color: rgb(192, 192, 192);
      font-family: 'Ubuntu mono';
      font-size: 1em;
      color: #333;
      width: fit-content;
      padding: 1em;
      display: block;
      width: auto;
      overflow-wrap: normal;
      white-space: break-spaces;
      word-break: break-word;
    }

    .code b {
      overflow-wrap: normal;
      white-space: pre-wrap;
    }

    .attentionDiv, .demo {
      background-color: #338;
      color: #fff;
      border-style: solid;
      border-radius: 1em;
      padding: 0.5em;
      margin: 1em auto;
      width: 100%; 
    }

    h1, h2, h3, h4, p, a {
      font-family: Ubuntu, Arial, Helvetica, sans-serif;
      margin: 1em auto;
    }

    h1 {
      font-size: 32px;
    }

    h2 {
      font-size: 29px;
    }

    h3 {
      font-size: 26px;
    }

    h4 {
      font-size: 23px;
    }

    p {
      font-size: 20;
    }

    a {
      background-color: #ffffffe6;
      padding: 0.5em;
      border-style: solid;
      border-color: #338;
      border-radius: 0.5em;
      display: block;
    }

    li a {
      background-color: #ffffff;
      padding: 0.4em;
      border-style: none;
      line-height: 2em;
      font-size: 1.2em;
    }

    body {
      background-color: #000;
      color: #fff;
      width: 100%;
    }

  </style>
</head>
<body>
  <h1>SwiftCal - A Calendar and Time Picker Web Component</h1>
  
  <h2><a href=" https://github.com/festinalente/SwiftCal2/">GitHub repo</a></h2>
  <h2><a href="#examples">View more examples</a></h2>
  <h2><a href="https://www.npmjs.com/package/swiftcal2">View on NPM</a></h2>

  <div class="eg"></div>

  <div class="attentionDiv">
    <h2>Index:</h2>
    <ul>
      <li><a href="#todo">How to use</a></li>
      <li><a href="#data">The dynamicData object</a></li>
      <li><a href="#events">Custom events emitted</a></li>
      <li><a href="#customizing">How to customize</a></li>
      <li><a href="#instantiation">Two ways to instantiate</a></li>
      <li><a href="#examples">Examples</a></li>    
      <li><a href="#usage">Future features planned</a></li>
    </ul>
  </div>

  <div class="attentionDiv">
    <h2 id="usage">Usage</h2>
    <h3>Loading the component</h3>
    <p>Load the ./clientSideJS/calendar.js in your page passing the <b>defer</b> attribute,</p>
    <pre class="code">
&lt;script defer src=&quot;./clientSideJS/calendar.js&quot;&gt;&lt;/script&gt;

<b>Or from a CDN:</b>

&lt;script defer src=&quot;https://cdn.jsdelivr.net/gh/festinalente/SwiftCal2/clientSideJS/calendar.js&quot;&gt;&lt;/script&gt;
    </pre>
    <p>Then add a tag to your markup where you want the calendar,</p>
    <div class="code">&lt;swift-cal&gt;&lt;/swift-cal&gt;</div>
    <p>Options are passed as data-attributes. The example bellow sets the calendar to display 12 months into the future:</p>
    <div class="code">&lt;swift-cal data-number-of-months-to-display='12'&gt;&lt;/swift-cal&gt;</div>
    <h3>Retrieving data</h3>
    <p>Data is retrieved directly from the WebComponent, you can access it with a querySelector. The function dynamicData() returns the data:</p>
    <div class="code">document.querySelector('.calendar-container').dynamicData()</div>
  </div>

  <div class="attentionDiv">
    <h2 id="data">The dynamicData object</h2>
    <p>Data from the calendar is stored in an object called "dynamicData". This object can be accessed directly from the WebComponent 
      with the calendar.dynamicData().</p>
    <p>The example below shows the form the data takes:</p>  
    <pre class="code dataexample">

    </pre>
     
  </div>

  <div class="attentionDiv">
    <h2 id="events">Custom Events</h2>
    <p>You can listen for an event that is fired every time a selection is made, there are two custom events:</p>
    <ol><li>timeSelect - fired when a time is selected</li><li>dateSelect - fired when a date is selected</li></ol>
    <p>You can listen for these as you would with a normal event:</p>
    <div class="code">calendar.addEventListener('timeSelect', function () { ... });</div>

  </div>

  <div class="attentionDiv">
    <h2 id="customizing">Developing and customising</h2>
    <p>To customize the calendar, follow these steps:</p>
      <ol>
        <li>git clone https://github.com/festinalente/SwiftCal2.git</li>
        <li>cd to the folder SwiftCal2 and run "npm install"</li>
        <li>then run "grunt watch</li>
      </ol>
      <p>Now any changes you make will be written to and compiled (making the code backward compatible) automatically.</p>
    <h4>Appearance</h4>  
    <p>To simply change appearance without breaking anything, the best thing to do is to alter the variables in variables.scss.</p>
    <p>If you are a designer however and can make it look better, consider submitting a pull request.</p>
    <h4>Language and text</h4>
    <p>The easiest way to change language and or text is to edit the values in <em>./preBundlingJS/languages.js</em></p>  
  </div>

  <div class="attentionDiv">
    <h2 id="instantiation">Instantiation and Options</h2>
    <h3>Instantiation via HTML</h3>
    <p>The calendar can be used as a web component by simply adding an element to the page</p>
    <div class="code">&lt;swift-cal&gt;&lt;/swift-cal&gt;</div>
    <h4>Options passed in data attributes using dash case</h4>
    <p>Various options can be passed to the calendar as data parameters. These parameters are string representations
      of primitives e.g. int, boolean, string etc.</p>
    </p>
    <ul>
      <li><span class="code">data-number-of-months-to-display='12' - The number of months the calendar displays (whole number) </span></li>
      <li><span class="code">data-display-time-chooser-modal='true' - Toggle time chooser on date select (Boolean)</span></li>
      <li><span class="code">data-single-date-choice='true' - Limit date choice to a single day (Boolean)</span></li>
      <li><span class="code">data-language='enGb' - Set language: 'enGb' and 'ptPt' available now</span></li>
      <li><span class="code">data-selected-multiple='true' - Allow multiple dates to be selected (Boolean)</span></li>
      <li><span class="code">data-preloaded-dates='["2023-10-30","2023-10-31","2023-11-01"]'- Allows dates to be added to the calendar
        and selection limited to those dates</span></li>
      <li><span class="code">data-preloaded-tooltip - Sets a title attribute on each preloaded date</span></li>
    </ul>

    <h3>Instantiation via JavaScript</h3>
    <p>The calendar can be instantiated via JavaScript and parameters passed in an object. The big difference is the requirement to pass
      a parent element to the calendar.</p>
    
      <h4>Example code used to instantiate the first calendar at the top of this page: </h4>
      <div class="code">
        const cal = new calendar.SwiftCal();
        cal.generateCalendar({ 
          parentDiv: '.eg', 
          numberOfMonthsToDisplay: 3,
          displayTimeChooserModal: false
        });
      </div>

    <h4>Options passed via an object to the generateCalendar() function using camel case -these are otherwise the same as the options passed to in html data attributes:</h4>
    <ul>
      <li>parentDiv: <em>HTML querySelector</em> // a valid querySelector, </li>
      <li>numberOfMonthsToDisplay: <em>int</em> // any whole number,</li>
      <li>displayTimeChooserModal: <em>boolean</em> // true or false,</li>
      <li>singleDateChoice:<em>boolean</em> // true or false,</li>
      <li>language: <em>string</em> // 'enGb' and 'ptPt' available now,</li>
      <li>selectedMultiple: <em>boolean</em> // true or false,</li>
      <li>preloadedDates: <em>array of string</em> // ["2023-10-30","2023-10-31","2023-11-01"],</li>
      <li>preloadedTooltip: <em>string</em> // text to display on a preloaded date on hover,</li>
    </ul>
  </div>
  
  <h2 id="examples" style="margin-left: auto; margin-right: auto; text-align: center;">Examples:</h2>
  <div class="demos"></div>

  <div class="attentionDiv">
    <h2 id="todo">TODO</h2>
    <ul>
      <li>A method to pick predefined times. (e.g. to schedule an appointment),</li>
      <li>An option to disallow selecting end times that are before start times,</li>
      <li>Ability to set the calendar for passed dates,</li>
      <li>Ability to add notes or information to a day and to specific time blocks,</li>
      <li>Ability to apply rules to day in every week (e.g. block all Sundays),</li>
      <li>Write tests.</li>
    </ul>
  </div>

  <div class="attentionDiv" style="background-color:#fff">
    <a href="mailto:tomas@appyou.pro">Have a feature request, improvement suggestion or a job for me? Mail me.</a>
  
    <a href="https://github.com/festinalente/SwiftCal2/issues">Bugs can be files under issues on GitHub.</a>  
  </div>

</body>

<script>
  const example = `{

<b>datesSelectedArray is mostly used for tracking internally.
The outer array is all the dates selected (one or more ranges).
The inner array is specific ranges of succesive dates.</b>

  "datesSelectedArray": [
    [
      "2023-11-08"
    ]
  ],
  "datesSelectedArrayObjects": [
    [
<b>
  <ul>
    <li>day -the day of the month</li>
    <li>'humandate' -a YYYY-MM-DD date for end user use</li>
    <li>index -used internally, start on day 1 of those displayed</li>
    <li>UTC - UTC date string for a date</li>
    <li>Times are stored as objects with a name (start, end)and values for hour and minute</li>
    <li>UTC Date/time string is added for specific time</li>
  </ul>
</b>
      { 
        "day": "8",
        "humandate": "2023-11-08",
        "index": "38",
        "UTC": 1699401600000,
        "times": [
          {
            "Start": {
              "hh": "09",
              "mm": "00"
            },
            "UTC": 1699434000000
          },
          {
            "End": {
              "hh": "13",
              "mm": "00"
            },
            "UTC": 1699448400000
          }
        ]
      }
    ]
  ],

<b>disabled -boolean to disable the calendar -not implemented, might be removed.</b>
  "disabled": false
}`;


  document.querySelector('.dataexample').innerHTML = example;
  
  window.setTimeout(()=> {
    const cal = new calendar.SwiftCal();
    cal.generateCalendar({ 
      parentDiv: '.eg', 
      numberOfMonthsToDisplay: 3,
      displayTimeChooserModal: false
    });
  }, 1000);

  function datesInFuture () {
    const dates = [];
   
   
    function generateDate (offset) {
      const timeStamp = Date.now();
      const addOffset = (timeStamp + (60 * 60 * 24 * 1000 * offset));
      const date = new Date(addOffset);
      let day = date.getDate();
      (day.toString().length === 1) ? day = `0${day}` : day;
      const month = (date.getMonth() + 1);
      const year = date.getFullYear();
      const formated = `${year}-${month}-${day}`;
      return formated;
    }
    for (let i = 10; i < 23; i++) {
      dates.push(generateDate(i)); 
    }

    for (let i = 30; i < 43; i++) {
      dates.push(generateDate(i)); 
    }
    return JSON.stringify(dates);
  }

  const demoData = [
    {
      title: `Bellow is a calendar rendering default values and settings:`,
      html: `<swift-cal></swift-cal>`
    },
    {
      title: `Bellow is a calendar with preloaded dates, dates are highlighted in cyan and tooltip text can be added.
      Note that the preloaded dates are a sting representation of an array.`,
      html: `<swift-cal
              data-preloaded-dates=${datesInFuture()}
              data-preloaded-tooltip='This date is available'
              >
            </swift-cal>`
    },
    {
    title: 'Bellow is a calendar in Portuguese, with three months, allowing a single date to be selected:',
    html: `<swift-cal 
            data-number-of-months-to-display="3" 
            data-language="ptPt" 
            data-single-date-choice="true">
          </swift-cal>`
    },
    {
      title: `Bellow is a calendar in English that allows multiple date ranges to be selected and times added
    for each date in the range. Single dates can be added as a range by triple clicking on a date:`,
      html: `<swift-cal data-display-time-chooser-modal="true"></swift-cal>`
    },
    {
      title: `Bellow is a calendar in Portuguese, with two months, allowing multiple date range selections, but not time:`,
      html: `<swift-cal data-number-of-months-to-display="2" data-language="ptPt"></swift-cal>`
    },
    {
      title: `Bellow is a calendar in English, with three months allowing a single date to be selected that also toggles a time picker:`,
      html: `<swift-cal 
              data-number-of-months-to-display="3" 
              data-language="enGb" 
              data-single-date-choice="true"
              data-display-time-chooser-modal="true">
            </swift-cal>`
    },
    {
      title: `Bellow is a calendar in Portuguese, with two months, allowing a single date to be selected that also toggles a time picker:`,
      html: `<swift-cal 
              data-number-of-months-to-display="2" 
              data-language="ptPt" 
              data-single-date-choice="true"
              data-display-time-chooser-modal="true">
            </swift-cal>`
    }
  ];

  function generateView (demoData) {
    const parent = document.querySelector('.demos');

    const demoContainer = document.createElement('div');
    demoContainer.classList.add('demo');
    parent.appendChild(demoContainer);

    const title = document.createElement('h3');
    title.textContent = demoData.title;
    demoContainer.appendChild(title);
    
    const markup = document.createElement('h4');
    markup.textContent = "The html:";
    demoContainer.appendChild(markup);

    const htmlExample = document.createElement('div');
    htmlExample.classList.add('code');
    htmlExample.textContent = demoData.html
    demoContainer.appendChild(htmlExample);

    const result = document.createElement('h4');
    result.textContent = "The result:";
    demoContainer.appendChild(result);

    const example = document.createElement('div');
    example.innerHTML = demoData.html;
    demoContainer.appendChild(example);

    const selectData = document.createElement('h4');
    selectData.textContent = "Select dates/times. Stored data is shown bellow and can be fetched via the 'calendar.dynamicData()' method: ";
    demoContainer.appendChild(selectData);

    const userData = document.createElement('div');
    userData.classList.add('code');
    demoContainer.appendChild(userData);

    example.querySelector('swift-cal').addEventListener(
      'dateSelect',
      (e) => {
        userData.innerHTML = JSON.stringify(e.target.dynamicData);
      },
      false,
    );

    example.querySelector('swift-cal').addEventListener(
      'timeSelect',
      (e) => {
        userData.innerHTML = JSON.stringify(e.target.dynamicData);
      },
      false,
    );
  }

  demoData.forEach((data) => {
    generateView(data);
  });


</script>